<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chapter2</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    </html>
    <h1>ネットワークの構築</h1>
    <p>VPC領域を構成するとAWS上にスキな校正のネットワークを構築できます。</p>
    <h2>IPアドレス範囲を定める</h2>
    <div>
        AmazonVPCを用いてVPC領域を構成するとユーザーごとに隔離されたネットワークを作れます<br>
        作ったネットワークの中では任意のネットワーク設定ができ、ルーターなどの仮想的なネットワーク機器を配置できます。
        <br>
        しかしこれには一つだけ注意点があり
        <strong>VPC領域に割り当てるIPアドレスの範囲を決めなくてはならないのです</strong>

>>>>>>> Stashed changes
    </div>
    <h3>パブリックIPアドレスとプライベートIPアドレス</h3>
    <div>
        インターネットで使われているプロトコルはTCP/IPと呼ばれるものです<br>
        IPアドレスはネットワーク上で互いに重複しない有意ツムにの番号で32ビットで構成されたものです
    </div>
    <h4>パブリックIPアドレス</h4>
    <div>
        IPアドレスは重複すると正しく通信できないためにIPアドレスを管理する方針としてICANNという団体が決めたものに則って範囲を限定しないといけません。
        <br>
        インターネットに接続する際に用いるIPアドレスはプロバイダーやサーバー事業者から貸し出されます
        <br>

    </div>
    <div class="box">
        <h4>IPアドレスの割り振りと再配布</h4>
        <div>
            IPアドレスはICANNが一括管理し、必要に応じて、その配下の団体へと配布する仕組みが取られています。<br>
            配下の団体は地域、国、プロバイダーなどです
            <br>
            プロバイダーは上位団体であるJPNICという団体にIPアドレスを申請して、あらかじめエンドユーザーの数に見合ったIPアドレスを確保しています。
            <br>
            JPNICの上にはAPNICという上位団体がいます
            <br>
            現在はIPv4だがドメインが足りなくなっているのでIPv6に移行する必要がある
            <br>
            そしてそれはあまり簡単ではない


        </div>
    </div>
    <h4>自由に利用できるプライベートIPアドレス</h4>
    <div>
        誰にも申請せずに使えるIPアドレス
        <br>
        <table>
            <tr>IPアドレス範囲
                <td>10.0.0.0-10.255.255.255</td>
            </tr>
            <tr>
                <td>172.16.0.0-172.31.255.255</td>
            </tr>
            <tr>
                <td>192.168.0.0-192.168.255.255</td>
            </tr>

        </table>

    </div>

    <h3>IPアドレス範囲と表記方法</h3>
    <div>
        ネットワークを構築するとき、まずその範囲内で使うIPアドレスの範囲を定める必要があります
        <br>
        実験用であれば、先程のひょうの中からネットワーク機器の数を確保した範囲を定めます。
        <br>
        通常使うのは256か65536個です
        <br>
        IPアドレスの前半部はネットワーク部、後半をホスト部と呼びます
        <br>
        ネットワーク部は同じネットワークに属す限りは同じ値、ホスト部は連番
    </div>
    <h5>CIDR表記とサブネットマスク表記</h5>
    <div>
        CIDR表記はネットワーク部のビット長を[/ビット長]
        サブネットマスクはプレフィックスのビット長だけ０を並べる表記のことです
    </div>
    <strong>
    AMAZON VPCの特徴はプレフィック長として16以上を指定する必要があります</strong>

    <h3>実際にやってみる</h3>
    <div class="practice">
        <strong>
        VPC領域を作成。CIDRブロックは10.0.0.0/16で作成します。
        </strong>
        <br>
        次にVPCをサブネットに分割する
        <br>
        例としては/24のサブネットに分割することで小さなネットワークが内部に存在するように扱える
        <br>
        ①パブリックサブネット(10.0.1.0/24)
        <br>
        ネットワーク上に公開するサブネット
        <br>
        ②プライベートサブマスク
        <br>
        インターネットから隔離しているサブネット、データベース・サーバーを置く
        <div class="small">
            これなら10.0.3.0/24や10.0.4.0/24などがあまるし、そもそも10.0.0.0/16じゃなくて10.0.0.0/22で足りるじゃん
            <br>
            そうなんだけど拡張性とピリオド2つ分で見やすいから24にするのが普通らしい
        </div>
        さてじっさいやる
        <br>
        注意点としてアベイラビリティゾーンを指定して、複数のサブネットを違うところに一つのアベイラビリティゾーンで障害が起こったときにその影響の範囲を抑えられるというものがあります
        <br>
        <h4>インターネットゲートウェイを設定する</h4>
        <div>
            イメージとしては自分のネットワークにインターネット回線を引き込むようなもの
            <br>ここでは名前はデフォルトのままでいいが、複数のゲートウェイを設定するときは名前付けは必須
            <br>作成が終わったら、先程作ったVPCにアタッチしましょう
        </div>
        <h5>ルーティング</h5>
        <div class="routes">
            ネットワークに情報を流すときに必要な設定。ルーティングテーブルとかルートテーブルと呼ばれる
            <br>
            TCP/IPではパケット単位でデータを送受信します。
            <br>
            パケットはヘッダー情報とデータの実体を含んでおり、ヘッダー情報の一つに宛先IPアドレスがあります
            <br>
            宛先IPアドレスを見て、適切なルーティングでデータを送るときにつかう経路情報がルートテーブルです
            <br>
            このとき宛先アドレスのことをディスティネーションと呼びます
            <br>
            流すべきネットワーク先はネクストホップやターゲットと呼びます（AWSではターゲット）
            <br>
            <div class="box">
                普通のルーティングは直接接続されていないホストへのパケットをその経路のルータに流すようなルートテーブルを書く
                <br>
                VPCでもルータの代わりを果たすようなソフトウェアがはたらいているので、各サブネットに対してルートテーブルを設定する
                <br>
                VPC領域を作った直後にはデフォルトのルートテーブルが作られています。サブネットを作ったときにも同じようにデフォルトのやつが適応されています
                <br>
                <strong>かくにんしよ</strong>
                <br>確認した結果、デフォルトのテーブルには10.0.0.0/16　の送信先に対してターゲットがlocalとなっていた
                <br>つまり、10.0.0.0/16は自分のVPCのCIDR領域であり、そこに送られるということは作ったVPC内部の通信ということ、それがlocalに送られるというのは仮想的に作られたルータが先程作ったVPC内部への通信はそのネットワークへ流すが、それ以外は破棄するということを意味する。
                <br>しかしこのままだとインターネットに接続することができないので、宛先不明なやつを全部インターネットゲートウェイに接続するようにする。つまりデフォルトゲートウェイをインターネットゲートウェイに割り当てるということが必要になる。

            </div>
            <div class="connectToInternet">
                パブリックサブネットの方をインターネットに接続するためには、新しいルートテーブルをつくって転送先が何も設定されていないときのデフォルトの転送先をインターネットゲートウェイにする必要がある
                <br>
                言い換えるとインターネットゲートウェイをデフォルトゲートウェイとして設定するということ
                <strong>このとき編集するのはインターネットゲートウェイの方ではなく、ルートテーブルの方だということ</strong>
                <br>詳しくはいかに

                <h4>手順</h4>
                <div class="practice">
                    <ol>
                        <li>ルートテーブルを新規作成</li>
                        <li>サブネットと関連付ける</li>
                        <li>デフォルトゲートウェイをインターネットゲートウェイにする</li>
                        コレはルートの追加をして、10.0.0.0/16に追加して、0.0.0.0/0が送信先のときには作成しておいたインターネットゲートウェイに接続するような設定にするといいです
                    </ol>
                </div>
            </div>
        </div>

    </div>


</body>
