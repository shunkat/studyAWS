<h1>システム構築をインフラから始める</h1>
<p>2021-01-14</p>
<h2>アプリケーション開発者にとてネットワークやサーバーを知ることによってメリット</h2>
<p>殆どの開発現場ではネットワーク管理者やサーバー管理者が用意したものをアプリケーション開発者が利用する</p>
<p>セキュリティなどの高度なものをアプリケーション開発者が理解するのは難しいから</p>
<p>しかしテスト環境ぐらいは自分で作ってもよいのではないだろうか</p>


<h2>構築手順</h2>
<h3>サーバーの構成</h3>
<p>まずはどのようなサーバーを作るか考えます</p>
<p>webサイトを作るにはwebサーバーが必要です</p>
<p>データベースを作るにはデータベースサーバーが必要です</p>
<p>メールを送受信するにはメールサーバーが必要です</p>
<strong>しかし実際には同じようなサーバーにそれぞれの機能を果たすためのソフトウェアがインストールされているものに過ぎないのです</strong>
<p>そもそもサーバーというのはlinuxやwindowsなどサーバー用のOSをインストールしただけのコンピューターにすぎない</p>
<p>サーバーにはどのようなソフトウェアをインストールするのかによってサーバーの役割が変わります</p>
<span>サーバーに複数のソフトウェアをインストールすることもできます</span>
<h3>サーバーを構築するのに必要な知識</h3>
<ul>
    <li>サーバーOSのインストール方法</li>
    <li>各ソフトウェアのインストールや設定方法</li>
</ul>
<p>webサーバーとして機能させたいのならapache HTTP Serverやnginxなど</p>
<p>データベース・サーバーとして機能させたいのならMySQL,MariaDB,PostgreSQL</p>

<h3>networkの知識</h3>
<p>TCP/IPというプロトコルを使って通信する</p>
<p>それぞれのサーバーにIPアドレスと言う番号を割り振る</p>
<p>またルーターという機会にデータが流れるようにしておかないとインターネットと通信できない</p>
<p>またインターネットにアクセスするにはhttp://hogehogeのようなドメイン名でアクセスしなくてはならない</p>
<p>ドメイン名はIPアドレスに付随する人間がわかりやすいものでそれを使うにはDNSサーバーの設定も必要</p>
<h3>ネットワークの構築に必要な知識</h3>
<ul>
    <li>IPアドレスに関連する知識</li>
    <li>DNSサーバーに関する知識</li>

</ul>
<div>データの流れを覗き見るツールを使う必要があり、主としては
    <li>ping</li>
    <li>traceroute</li>
    <li>telnet</li>
    <li>nslookup</li>
    <li>dig</li>
    などがある<br>
    直接見たかったらwiresharkなどのネットワークプロトコルアナライザ<br>
    webサイトの表示に利用されるhttpプロトコルに限ったデバッグをしたければwebブラウザに付属のツールを利用する
</div>

<div>これ以降は実際にwordpressサイトを作って勉強していく
    利用するサーバーはwebサーバーとdbサーバーの二台<br>
</div>

<div>
    本書で構成するネットワークは２つに分かれている<br>
    一つはパブリックサブネットというインターネットに接続し公開されているもの、ここにwebサーバーを配置する<br>
    もう一つはプライベートサブネットと呼ばれる直接インターネットには接続しないもので、ここにDBサーバーを配置する
</div>
<h3>NAT</h3>
<div>
    DBサーバーがインターネットに全く接続していない場合各種必要なソフトウェアのインストールやアップデートができなくて困る<br>
    そこで<strong>NAT</strong>を導入します。<br>
    NATはnetwork address translationの略で内部だけで通用するアドレスを外部とも通信できるアドレスに変換する技術のことです<br>
    つまりDBサーバーはインターネットに接続できるが、外部からの接続はできないということ
    ただしDBサーバーから外部に通信した際の戻りはOK
</div>
<h2>物理的なネットワークとAWS</h2>
<div>普通ならこれらの環境を試すには
    <li>回線</li>
    <li>サーバー</li>
    <li>ネットワーク機器</li>
    を用意しなくてはならず、なかなか気軽には試せない<br>
    そこでAWSをつかう
</div>
<h3>AWS上の特殊な用語</h3>
<div>
    <h4>リージョン</h4>
    AWSは現在時点で世界２２箇所の分散されたデータセンター軍で構成されています<br>
    それぞれの地域に存在するデータセンター軍のことをregionと呼ぶ<br>
    例えばバージニアリージョンや東京リージョンなど

    <h4>アベイラビリティーゾーン</h4>
    それぞれのリージョンはアベイラビリティゾーンに分割されている<br>
    それぞれのアベイラビリティゾーンは物理的に距離が離されて、独立したファシリティを用いています
    <br>
    AWSで仮想的なネットワーク(VPC)や仮想的なサーバー（EC2)を構築する場合、どのリージョンのどのアベイラビリティゾーンに置くかを決めなくてはならない<br>
    エンドユーザーに近い距離のリージョンはレスポンスがよい<br>
    耐障害性を高めるために異なるアベイラビリティゾーンに同じ構成のサーバーをたてて負荷分散する<br>
    など考慮することがたくさんある
    cf）本来は複数のアベイラビリティゾーンに分散するが今後の演習では東京リージョンの一つのアベイラビリティゾーンにたてる

</div>

<div>
    <h2>ネットワークとVPC</h2>
    AWSではAmazon VPCと呼ばれる領域を作るとそこに自由なネットワークを作ることができる<br>
    そのVPC内部でいくつかのネットワークに分割して利用し、その時のそれぞれのネットワークをサブネットと呼びます。<br>
    サブネットの中にはサーバー（amazon EC２インスタンス）を設置できます
</div>

<div id="ec2">
    AWSではamazon elastic cloud(EC2)とよばれるサービスを使ってサーバーを作り、それぞれのサーバーはインスタンスと呼ばれます。<br>
    インスタンスを作るときはCPUのスペックやディスクの容量などを決めてやります<br>
    本書では実験的に契約してから一年間の無償利用範囲に含まれているt2.microというインスタンスタイプを使います
</div>

<div id="flow">
    <h3>
        本書の流れ
    </h3>
    <ul>
        <li class="chap2">ネットワーク構築</li>
        <li>サーバー構築</li>
        <li>HTTPの動きの確認</li>
        <li>HTTPの動きを確認</li>
        <li>プライベートサブネットの構築</li>
        <li>NATの構築</li>
        <li>DBを用いたブログシステムの構築</li>
        <li>TCP/IPによる通信の仕組みの理解</li>
    </ul>
</div>
